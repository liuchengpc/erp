<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="/css/base.css">
    <link rel="stylesheet" href="/css/reset.css">
    <link rel="stylesheet" href="/css/shop_upload.css">
    <link rel="stylesheet" href="/css/goodStyle.css">
    <link rel="stylesheet" href="/css/bootstrap.css">
    <script src="/js/jquery-1.12.4.js"></script>
    <script src="/js/wangEditor.js"></script>
    <script src="/js/bootstrap.js"></script>
    
    
	<link rel="stylesheet" type="text/css" href="/static/css/style.css"/>
	<link rel="stylesheet" type="text/css" href="/static/editor/dist/css/wangEditor.css"/>
	<style type="text/css">
		*{
			padding: 0;
			margin: 0;
		}
		a{
			color: #5E5E5E;
		}
		li{
			list-style-type: none;
		}
		#editor-trigger {
            height: 440px;
            max-height: 500px;
        }
		.fpsize li{
			display: inline-block;
			vertical-align: middle;
			margin-top: 6px;
			border: 1px solid #e2e1e3;
			text-align: center;
			width: 24.3%;
			line-height: 32px;
			border-radius: 2px;
		}
		.addProductPicBtn{
			position: relative;
			overflow: hidden;
		}
		.uploadImgFile {
		    position: absolute;
		    top: 0;
		    left: 0;
		    z-index: 4;
		    display: block;
		    width: 50px;
		    height: 50px;
		    cursor: pointer;
		    opacity: 0.0;
		}
		
		.cmxz{
			border: 1px solid #f05b23 !important;
		}
	</style>
	
	<script src="/static/js/jquery.colorbox-min.js" type="text/javascript" charset="utf-8"></script>
	<script src="/static/js/jquery-1.12.4.js" type="text/javascript" charset="utf-8"></script>
	<script src="/static/js/bootstrap.js" type="text/javascript" charset="utf-8"></script>
	<script src="/static/js/dialog.js" type="text/javascript" charset="utf-8"></script>
	<script src="/static/js/vue.js" type="text/javascript" charset="utf-8"></script>
	<script src="/static/js/axios.min.js" type="text/javascript" charset="utf-8"></script>
    
    
    
</head>
<body>

<div class="rightarea clearfix s" >
    <div class="mainarea clearfix">
        <div class="mainhead">
            <span class="title">商品上传</span>
        </div>
       <script type="text/javascript">
			//1.生成采购单主表id
			$.ajax({
				url:"[[@{/topage/uuid}]]",
				type:"get",
				data:"",
				success:function(data){
					//alert(data)
					$("#productCodeID").val(data)
				}
			});
       </script>
        <div class="mainbody">
                <!--上传开始-->
                <div class="uploadproduct clearfix">
                    <div class="rightdiv">
                        <div class="ptype">
                            <div class="listdiv">
                                <span id="fdsjofie"><i>*</i>商品货号</span>
                                <input type="text" id="productCodeID" class="inputtext" >
                                <span>商品品牌</span>
                                <input type="text" id="brand" class="inputtext" >
                            </div>
                            <!---->
                            <div class="listdiv">
                                <span><i>*</i>商品名称</span>
                                <input type="text" id="name" class="inputtext" style="width: 398px;" onchange="namecm()">
                                <script type="text/javascript">
                                	function namecm(){
                                		//alert(1)
                                		var name=$("#name").val();	//商品名称
	   		                   			 $.ajax({//根据尺码id删除（如此尺码被使用则提示被“占用，不能删除”）
	   	                   					url:"[[@{/CommodityController/selectAll}]]",
	   	                   					type:"get",
	   	                   					data:"commoditysizeid="+commoditysizeid,
	   	                   					dataType:"json",
	   	                   					success:function(res){
	   	                   						$.each(res,function(i,obj){
	   	                   							if(obj.name==name){
	   	                   							  $("#name").focus()
	   	                   								retur false;
	   	                   							}
	   	                   						})
	   	                   					}
	   	                   				}) 
                                	}
                                	
                                </script>
                            </div>
                            <!---->
                            <div class="listdiv">
                                <span><i>*</i> 商品单价</span>
                                <input type="text" id="price" class="inputtext" >
                                <span><i>*</i>成本价格</span>
                                <input type="text" id="costPrice" class="inputtext" >
                            </div>
                            <!---->
                            <div class="listdiv">
                                <span><i>*</i>商品类别</span>
                                <select name="" id="commoditytypeid" class="form-control"  style="float:left;width: 168px;">
                                    <option value="" >请选择类别</option>
                                </select>
                          
                                <span><i>*</i>供应商</span>
                                <select name="" id="supplierID" class="form-control"  style="float:left;width: 168px;">
                                    <option value="" >请选择供应商</option>
                                </select>
                            </div>
                            <script type="text/javascript">
	                             $.ajax({//获取类别
	                            	url:"[[@{/CommoditytypeController/selectAll}]]",
									success:function(res){
										console.info("获取类别")
										console.info(res)
										$("#commoditytypeid").html("");
										var a='<option value="" >请选择类别</option>';
										$("#commoditytypeid").append(a);
										$.each(res,function(i,obj){
											var s='<option value="'+obj.commoditytypeid+'" >'+obj.commoditytypename+'</option>';
											$("#commoditytypeid").append(s);
										})
									}
								})
								
								$.ajax({//获取供应商
									url:"[[@{/SupplierController/selectAll}]]",
									success:function(res){
										console.info("供应商")
										console.info(res)
										$("#supplierID").html("");
										var a='<option value="" >请选择供应商</option>';
										$("#supplierID").append(a);
										$.each(res,function(i,obj){
											var s='<option value="'+obj.supplierid+'" >'+obj.companyname+'</option>';
											$("#supplierID").append(s);
										})
									}
								})
								$.ajax({//获取尺码
									url:"[[@{/CommoditysizeController/selectAll}]]",
									success:function(res){
										console.info("")
										console.info(res)
										var a='<option value="请选择类别" >请选择类别</option>';
										$.each(res,function(i,obj){
											var s='<li>'+
								     				'<a href="javascript:void(0);" commoditySizeID='+obj.commoditysizeid+'>'+obj.commoditysize+'</a>'+
								     				'<span style="float: right;display: none" name="chima" class="glyphicon glyphicon-remove" @click="del(stu.goodssizeid)"   onclick="sc(this)"></span>'+
								     			'</li>';
								     	
											$("#commoditySizeID").append(s);
										})
									
							     		niubi();
							     		
									}
								}) 
                            </script>
                            	
                            
                         
                            
                            <!--商品尺码颜色   E-->                            	
                        	<form class="form-horizontal" action="" method="post">
								
								
								<div name="colorbao">
									<div class="form-group" style="line-height: 34px;margin-bottom: 0px;">
									    <span for="inputEmail3" class="col-sm-3" style="float: left;    width: 81px;    text-align: right;    font-size: 14px;    line-height: 36px;    padding-right: 10px;    color: #9e9e9e;    position: relative;">
									    	<i style="color: #f24d4d;font-size: 14px;font-style: normal;font-weight: normal;left: 0px;position: absolute;top: 4px;">*</i>
									    	商品颜色
									    </span>
									    <div class="col-sm-10">
									      <table class="table table-bordered">
											 <thead align="center">
												 <tr class="active">
												 	<td>黑色系</td>
												 	<td>白色系</td>										 	
												 	<td>红色系</td>
													<td>蓝色系</td>
												 </tr>
											 </thead>
											 <tbody>
												 <tr>
												 	<td>
												 		<input type="checkbox" style="float: left;margin: 4px 0px 0px 8px;"/>
												 		<a href="javascript:;">
												 			<span style="float:left;margin:1px 2px 0px 2px;width: 14px;height: 14px;background-color: #000000;">
												 				
												 			</span>
												 			<span colorID="1">黑色</span>
												 		</a><br/>
												 		<input type="checkbox" style="float: left;margin: 4px 0px 0px 8px;"/>
												 		<a href="javascript:;">
												 			<span style="float:left;margin:1px 2px 0px 2px;width: 14px;height: 14px;background-color: #666666;">
												 				
												 			</span>
												 			<span colorID="2">深灰色</span>
												 		</a><br/>
												 		<input type="checkbox" style="float: left;margin: 4px 0px 0px 8px;"/>
												 		<a href="javascript:;">
												 			<span style="float:left;margin:1px 2px 0px 2px;width: 14px;height: 14px;background-color: #E4E4E4;">
												 				
												 			</span>
												 			<span colorID="11">浅灰色</span>
												 		</a>
												 	</td>
												 	<td>
												 		<input type="checkbox" style="float: left;margin: 4px 0px 0px 8px;"/>
												 		<a href="javascript:;">
												 			<span style="float:left;margin:1px 2px 0px 2px;width: 14px;height: 14px;background-color: #FFFFFF;border: 1px solid #F8F8F8;">
												 				
												 			</span>
												 			<span colorID="3">白色</span>
												 		</a><br/>
												 		<input type="checkbox" style="float: left;margin: 4px 0px 0px 8px;"/>
												 		<a href="javascript:;">
												 			<span style="float:left;margin:1px 2px 0px 2px;width: 14px;height: 14px;background: url(http://style1.buyinchina.com/img/addProductColor.gif) no-repeat scroll 0 -20px transparent;">
												 				
												 			</span>
												 			<span colorID="4">透明</span>
												 		</a><br/>
												 		<input type="checkbox" style="float: left;margin: 4px 0px 0px 8px;"/>
												 		<a href="javascript:;">
												 			<span style="float:left;margin:1px 2px 0px 2px;width: 14px;height: 14px;background: url(http://style1.buyinchina.com/img/addProductColor.gif) no-repeat scroll 0 0 transparent;">
												 				
												 			</span>
												 			<span colorID="12">花色</span>
												 		</a>
												 	</td>										 	
												 	<td>
												 		<input type="checkbox" style="float: left;margin: 4px 0px 0px 8px;"/>
												 		<a href="javascript:;">
												 			<span style="float:left;margin:1px 2px 0px 2px;width: 14px;height: 14px;background-color: #990000;">
												 				
												 			</span>
												 			<span colorID="13">酒红色</span>
												 		</a><br/>
												 		<input type="checkbox" style="float: left;margin: 4px 0px 0px 8px;"/>
												 		<a href="javascript:;">
												 			<span style="float:left;margin:1px 2px 0px 2px;width: 14px;height: 14px;background-color: #FF0000;">
												 				
												 			</span>
												 			<span colorID="5">红色</span>
												 		</a><br/>
												 		<input type="checkbox" style="float: left;margin: 4px 0px 0px 8px;"/>
												 		<a href="javascript:;">
												 			<span style="float:left;margin:1px 2px 0px 2px;width: 14px;height: 14px;background-color: #FFB6C1;">
												 				
												 			</span>
												 			<span colorID="14">粉红色</span>
												 		</a>
												 	</td>
													<td>
														<input type="checkbox" style="float: left;margin: 4px 0px 0px 8px;"/>
												 		<a href="javascript:;">
												 			<span style="float:left;margin:1px 2px 0px 2px;width: 14px;height: 14px;background-color: #041690;">
												 				
												 			</span>
												 			<span colorID="6">深蓝色</span>
												 		</a><br/>
												 		<input type="checkbox" style="float: left;margin: 4px 0px 0px 8px;"/>
												 		<a href="javascript:;">
												 			<span style="float:left;margin:1px 2px 0px 2px;width: 14px;height: 14px;background-color: #0000FF;">
												 				
												 			</span>
												 			<span colorID="15">蓝色</span>
												 		</a><br/>
												 		<input type="checkbox" style="float: left;margin: 4px 0px 0px 8px;"/>
												 		<a href="javascript:;">
												 			<span style="float:left;margin:1px 2px 0px 2px;width: 14px;height: 14px;background-color: #1EDDFF;">
												 				
												 			</span>
												 			<span colorID="16">天蓝色</span>
												 		</a>
													</td>
												 </tr>
											 </tbody>
										  </table>
									    </div>
									</div>
									<div class="form-group" style="line-height: 34px;margin-bottom: 0;">
									    <div class="col-sm-10 col-md-offset-2">
									      <table class="table table-bordered">
									      	<thead align="center">
												 <tr class="active">
												 	<td>黄色系</td>
												 	<td>绿色系</td>										 	
												 	<td>紫色系</td>
													<td>其他色系</td>
												 </tr>
											</thead>
											<tbody>
												<tr>
												 	<td>
												 		<input type="checkbox" style="float: left;margin: 4px 0px 0px 8px;"/>
												 		<a href="javascript:;">
												 			<span style="float:left;margin:1px 2px 0px 2px;width: 14px;height: 14px;background-color:  #FFA500;">
												 				
												 			</span>
												 			<span colorID="17">橘色</span>
												 		</a><br/>
												 		<input type="checkbox" style="float: left;margin: 4px 0px 0px 8px;"/>
												 		<a href="javascript:;">
												 			<span style="float:left;margin:1px 2px 0px 2px;width: 14px;height: 14px;background-color: #FFFF37;">
												 				
												 			</span>
												 			<span colorID="18">黄色</span>
												 		</a><br/>
												 		<input type="checkbox" style="float: left;margin: 4px 0px 0px 8px;"/>
												 		<a href="javascript:;">
												 			<span style="float:left;margin:1px 2px 0px 2px;width: 14px;height: 14px;background-color: #FFFFB1;">
												 				
												 			</span>
												 			<span colorID="7">浅黄色</span>
												 		</a>
												 	</td>
												 	<td>
												 		<input type="checkbox" style="float: left;margin: 4px 0px 0px 8px;"/>
												 		<a href="javascript:;">
												 			<span style="float:left;margin:1px 2px 0px 2px;width: 14px;height: 14px;background-color: #5D762A;border: 1px solid #F8F8F8;">
												 				
												 			</span>
												 			<span colorID="19">军绿色</span>
												 		</a><br/>
												 		<input type="checkbox" style="float: left;margin: 4px 0px 0px 8px;"/>
												 		<a href="javascript:;">
												 			<span style="float:left;margin:1px 2px 0px 2px;width: 14px;height: 14px;background-color: #008000;">
												 				
												 			</span>
												 			<span colorID="8">绿色</span>
												 		</a><br/>
												 		<input type="checkbox" style="float: left;margin: 4px 0px 0px 8px;"/>
												 		<a href="javascript:;">
												 			<span style="float:left;margin:1px 2px 0px 2px;width: 14px;height: 14px;background-color: #98FB98;">
												 				
												 			</span>
												 			<span colorID="20">浅绿色</span>
												 		</a>
												 	</td>										 	
												 	<td>
												 		<input type="checkbox" style="float: left;margin: 4px 0px 0px 8px;"/>
												 		<a href="javascript:;">
												 			<span style="float:left;margin:1px 2px 0px 2px;width: 14px;height: 14px;background-color: #4B0082;">
												 				
												 			</span>
												 			<span colorID="9">深紫色</span>
												 		</a><br/>
												 		<input type="checkbox" style="float: left;margin: 4px 0px 0px 8px;"/>
												 		<a href="javascript:;">
												 			<span style="float:left;margin:1px 2px 0px 2px;width: 14px;height: 14px;background-color: #800080;">
												 				
												 			</span>
												 			<span colorID="21">紫色</span>
												 		</a><br/>
												 	
												 		<input type="checkbox" style="float: left;margin: 4px 0px 0px 8px;"/>
												 		<a href="javascript:;">
												 			<span style="float:left;margin:1px 2px 0px 2px;width: 14px;height: 14px;background-color: #DDA0DD;">
												 				
												 			</span>
												 			<span colorID="22">浅紫色</span>
												 		</a>
												 	</td>
													<td>
														<input type="checkbox" style="float: left;margin: 4px 0px 0px 8px;"/>
												 		<a href="javascript:;">
												 			<span style="float:left;margin:1px 2px 0px 2px;width: 14px;height: 14px;background-color: #BDB76B;">
												 				
												 			</span>
												 			<span colorID="10">深卡其</span>
												 		</a><br/>
														<input type="checkbox" style="float: left;margin: 4px 0px 0px 8px;"/>
												 		<a href="javascript:;">
												 			<span style="float:left;margin:1px 2px 0px 2px;width: 14px;height: 14px;background-color: #855B00;">
												 				
												 			</span>
												 			<span colorID="23">褐色</span>
												 		</a><br/>
												 		
												 		<input type="checkbox" style="float: left;margin: 4px 0px 0px 8px;"/>
												 		<a href="javascript:;">
												 			<span style="float:left;margin:1px 2px 0px 2px;width: 14px;height: 14px;background-color: #D2691E;">
												 				
												 			</span>
												 			<span colorID="24">巧克力</span>
												 		</a>
													</td>
												 </tr>
											</tbody>
										  </table>
									    </div>
									</div>
								</div>
								
							
								<div class="form-group" style="line-height: 34px;margin-bottom: 0;">
								    <div style="display: none;" id="tab_none" class="col-sm-10 col-md-offset-2">
								      <table class="table table-bordered">
								      	<thead align="center">
											 <tr class="active">
											 	<td width="50%">颜色名称</td>
											 	<td width="50%">颜色图片</td>	
											 </tr>
										</thead>
										<tbody>
											
										
										</tbody>
									  </table>
								    </div>
								
								  	<div onclick="coloradd(this)" id="addColor" class="col-md-offset-10" style="cursor:pointer;color: #44b549;display: none;">
								  		 <span>+ 添加颜色 </span>
								  	</div>
								</div>
								
			
								<div class="form-group" style="line-height: 34px;">
								     <span for="inputEmail3" class="col-sm-3" style="float: left;    width: 81px;    text-align: right;    font-size: 14px;    line-height: 36px;    padding-right: 10px;    color: #9e9e9e;    position: relative;">
									    	<i style="color: #f24d4d;font-size: 14px;font-style: normal;font-weight: normal;left: 0px;position: absolute;top: 4px;">*</i>
									    	商品尺码
									    </span>
								    <div name="chimaya" class="col-sm-10">
								     	<ul class="fpsize" id="commoditySizeID">
									     	<template v-for="stu in goodssize">
									     		<template v-if="stu.size==goods.size">
									     			<li>
									     				<a href="javascript:void(0);" name="noundefined" style="color:red">{{stu.size}}</a>
									     				<span style="float: right;display: none" name="chima" @click="del(stu.goodssizeid)"  class="glyphicon glyphicon-remove"  onclick="sc(this)"></span>
									     			</li>
												</template>
												<template v-else>
									     			<li>
									     				<a href="javascript:void(0);">{{stu.size}}</a>
									     				<span style="float: right;display: none" name="chima" class="glyphicon glyphicon-remove" @click="del(stu.goodssizeid)"   onclick="sc(this)"></span>
									     			</li>
												</template>
									     	</template>	
									     	
								     	</ul>
								    </div>
								    <div class="col-md-offset-10" style="color: #44b549;">
								  		<span name="bjcm" onclick="enen()">编辑尺码</span>
								  	</div>
								</div>
								<div class="form-group" style="line-height: 34px; display: none;">
								     <span for="inputEmail3" class="col-sm-3" style="float: left;    width: 81px;    text-align: right;    font-size: 14px;    line-height: 36px;    padding-right: 10px;    color: #9e9e9e;    position: relative;">
									    	<i style="color: #f24d4d;font-size: 14px;font-style: normal;font-weight: normal;left: 0px;position: absolute;top: 4px;">*</i>
									    	库存总数
									    </span>
								    <div class="col-sm-3">
								      <input name="goodkuchun" v-model="goods.inventory" onblur="cnmd()" readonly="readonly" type="text" class="form-control" id="inputEmail3">
								    </div>
								    <div class="col-sm-7">
								      <i style="color: red;">请勿随意修改库存，以免影响库存准确性。</i>
								    </div>
								</div>
								
								<div class="form-group" style="line-height: 34px;margin-bottom: 0;">
								    <div name="goodskc" class="col-sm-10 col-md-offset-2">
								      <table class="table table-bordered">
										 <thead align="center">
										 	<tr class="active">
											 	<td>规格</td>
											 	<!-- <td>数量</td>	 -->									 	
											 	<td>条形码</td>
											</tr>
										 </thead>
										 <tbody>
										 	<template v-if="goods.color!=''">										 	
										 		<tr>
										 			<td><span>{{goods.color}}</span><span>——</span><span>{{goods.size}}</span></td>
										 			<td>{{goods.inventory}}</td>
										 			<td>{{goods.barcode}}</td>
										 		</tr>										 	
										 	</template>	
										 </tbody>
									  </table>
								    </div>
								</div>
								
							</form>
                            <!--商品尺码颜色   S-->
                        
                        
                        
                        
                        </div>
                    </div>
                    <!--infoend-->
                    <!--上传图片  放大 E-->
                   
                    
                  
	                    <div class="productshow clearfix">
	                        <div class="magni">
	                            <div class="tb-booth s310">
	                    			<div class="jqueryzoom"> 
										<!--h5支持自定义属性，而处理数据的自定义属性则以“data-”开头，
											这里就是cloudzoom自己封装的数据处理属性，传入参数其实就是个对象格式，
											zoomSizeMode是要等比例的操作模式，说白了就是你要操作哪个标签的等比例，
											但必须是子标签才可以，这里当然是img标签了；zoomImage则是要操作的哪个image了；
											autoInside则是对响应式布局的适应处理，如果页面大小变得小于或等于指定的宽度（像素），
											CloudZoom将在“内部”模式工作，如果不做响应式处理了，加不加都无所谓。最后title如果有值，
											就会显示，没值，就不显示咯	--> 
										<!-- <img id="img" class="cloudzoom" style="width: 380px !important;height: 380px !important; "  src="/images/1ae6ebff9aa427657a9df7461a7552c3.jpg" data-cloudzoom="zoomSizeMode:'image',zoomImage: '/images/1ae6ebff9aa427657a9df7461a7552c3.jpg',autoInside: 30" alt="呵呵哒" title=""/>  -->
	                    				<img id="img" class="cloudzoom" style="width: 380px !important;height: 380px !important; "  src="/images/fdsfasfsadfaf.jpg" data-cloudzoom="zoomSizeMode:'image',zoomImage: '/images/fdsfasfsadfaf.jpg',autoInside: 30" alt="呵呵哒" title=""/> 
	                    			</div>
	                            </div>
	                        </div>
	                      
	                        <!--下一张下一张-->
	                        <div class="staticPic clearfix">
	                            <span class="prev"></span>
	                            <span class="next"></span>
	                            <!--小图滚动区域-->
	                            <div class="smallPic">
	                                <div class="pic-list">
	                                	  <!--想切换多张图片，只需要改下面img中src中的路径，
	                                	  以及data-cloudzoom中两个img的路径，
	                                	  注意data-cloudzoom要和img中的路径一摸一样-->
	                                    <ul class="thumb">
	                                    	<!-- <li> 
												<img class="cloudzoom-gallery" src="/a.jpeg" data-cloudzoom="useZoom:'.cloudzoom',image:'/a.jpeg',zoomImage:'/a.jpeg'"/> 
											</li> -->
											
	                                        <li>
                                        	 	<form id ="form2" action="load/upload2" enctype="multipart/form-data" method="post" name="claimForm">
                                            		<input  type='file' class="uploadimg picturepaths" name="file" id="paperPath "  accept=".gif,.jpeg,.jpg,.png" onchange="wjsc(this)"/>
	                                           </form>
	                                            <a  class="imgd" href="javascript:;">
	                                                <img src="/images/storeindex/add_ico.png" alt="">
	                                            </a>
	                                        </li>
	                                     
	                                    </ul>
	                                 
	                                </div>
	                            </div>
	                        </div>
	                    </div>
                   
                    
                    <script>        
								var newsrc;//图片源地址
								var newsrc2;//上传图片地址
								function wjsc(td){//文件上传
										 // 图片上传到服务器
									 	var pic1 =  td.files;
									    var formData = new FormData();
									    // 服务端要求参数是 pic1
										for(var i=0;i<pic1.length;i++){
											formData.append("files",pic1[i]);
										}
										
										//\ int i=td.index()//获取当前是第几个文件上传
										//获取上传的第一个文件
											var file =  td.files[0];
											console.info("上传文件")
											console.info(file)
											var fileName = file.name;
											//var newsrc=getObjectURL(file);
											//alert("文件的name:"+fileName)
											var fileSize = file.size;
											//i忽略大小写匹配
											var nameReg = /\.gif|\.jpeg|\.jpg|\.png$/i;
											if(!nameReg.test(fileName)){
												//alert(fileName)
												alert("上传文件类型必须为.gif、.jpeg、.jpg、.png");
											}else if(fileSize>=5*1024*1024){
												alert("文件大小超出限制，只支持5M以内的文件上传");
											}else{
												console.info("------------------formData----------------------E")
					    				    	console.info(pic1)
					    				    	console.info(formData)
					    				    	console.info("------------------formData----------------------S")
												
										       $.ajax({
										               url:'[[@{/file/upload}]]',
										               type:'post',
										               data:formData,
										               //必须false才会自动加上正确的Content-Type
										               contentType: false,
										               //必须false才会避开jQuery对 formdata 的默认处理
										              //XMLHttpRequest会对 formdata 进行正确的处理
										              processData: false,
										              success:function(data){
										                  console.info("图片上传");
										                  console.info(data);
										                  if (data!="") {
										                	  newsrc2=data;
										                	  //alert(newsrc2)
										                	  var zoomSizeMode="useZoom:'.cloudzoom',image:'"+newsrc2+"',zoomImage:'"+newsrc2+"'";	
										                	  $("#form2").parents("li").removeClass("cloudzoom-gallery-active")
										                	  var tjimage="<li> "+
																			'<img class="cloudzoom-gallery  cloudzoom-gallery-active" src="'+newsrc2+'" data-cloudzoom="'+zoomSizeMode+'"/>'+ 
																		"</li>"	;
															  $("[name=file]").attr("commodityimg",newsrc2)	;//把地址添加到input=file
															  $("#form2").parents("li").prev().remove();
															  $("#form2").parents("li").before(tjimage)
															  
															 //$("#img").attr("src",newsrc2)
															
															 CloudZoom.quickStart();
															}
										              },
										              error:function(data){
										                  console.info("图片上传");
										            	  console.info(data);
										                  alert("后台发生异常");
										              },
										              cache:false,
										              async:true
										          }); 
											
											}
											 $(".cloudzoom-zoom img").attr("src",newsrc2)
								} 
								
					
					</script>
                      <!-- 图片上传 S -->
                    <style>
						/*.m{ width: 800px; margin-left: auto; margin-right: auto; margin-top: 100px}*/
						* { margin: 0; padding: 0; list-style-type: none; text-decoration: none; font: 16px '微软雅黑'; }
						/*外层盒子和里边图片的一点点样式*/
						.jqueryzoom { position: relative; padding: 0; border: solid 1px #eaeaea; width: 380px; height:380px; overflow: hidden; display: inline-block; }
						/*放大镜是基于图片大小自动生成的，每次都要把jqueryzoom中img的大小和jqueryzoom盒子大小设置为一样的，不然放大镜滑块有可能溢出*/
						.jqueryzoom img {width: 380px !important; }
					/*	ul li { float: left; margin-right: 5px; }
						ul li img { width: 100px; height: 100px; }
							.cloudzoom-gallery-active{opacity: .5}*/
					</style>
					<!--引入cloudzoom的css和js，顺序不要错，先css，再jQuery再cloudzoom的js，这个cloudzoom也是需要jQuery支持的，其实很多插件都是基于jQuery开发的-->
					<link href="/cloudzoom.css" rel="stylesheet"/>
					
					<script src="/jquery.min.js"></script>
					<script src="/cloudzoom.js"></script>
					<!--启动CloudZoom就可以了，quickStart()立即启动-->
					<script type="text/javascript">
						CloudZoom.quickStart();
					</script>
				 	<!-- 上传图片  放大 S-->
				 	
                    <!--富文本编辑器 保存商品信息 E-->
                    <div class="editPanel">
                        <p class="title">商品信息</p>

                        <div id="editwang"></div>
                        <!--按钮-->
                        <div class="btn-close-insert">
                            <a href="javascript:;" class="btn btn-default">取消发布</a>
                            <a href="javascript:;" class="btn btn-success" style="color: #ffffff !important;" onclick="submitClaimVoucher()">发布商品</a>
                        </div>
                    </div>
                    <script type="text/javascript">
					  
					   
					</script>
                    <!--富文本编辑器 保存商品信息 S-->
                </div>
        </div>
    </div>
</div>
</div>
    	<script src="/static/js/luowei.js"></script>
</body>

<script type="text/javascript">
	/*创建富文本编辑器*/
	var E = window.wangEditor;
	var editor = new E('#editwang');
	editor.create();
	
	var user=JSON.parse(window.sessionStorage.getItem("user"));
	
	function submitClaimVoucher(){
			if(!confirm("确定发布商品吗？")) return;
			
			
			var productcodeid=$("#productCodeID").val();//	商品货号
			var shoptype=$("").val();//	商品类型
			var supplierid=$("#supplierID").val();	//供应商ID
			var brand=$("#brand").val();	//商品品牌
			var name=$("#name").val();	//商品名称
			var price=$("#price").val();	//商品单价
			var costprice=$("#costPrice").val();//	成本价
			var commoditytypeid=$("#commoditytypeid").val();//	商品类型ID
			var commodityimg=$("[name=file]").attr("commodityimg");	//商品图片
			var stockcount=$("[name=goodkuchun]").val();//	库存
			var infomation=editor.txt.html();//	商品信息
			var shopid=user.shopid;
			
			
			
			
			
			var obj={
						productcodeid:$("#productCodeID").val(),//	商品货号
						shoptype:$("").val(),//	商品类型
						supplierid:$("#supplierID").val(),	//供应商ID
						brand:$("#brand").val(),	//商品品牌
						name:$("#name").val(),	//商品名称
						price:$("#price").val(),	//商品单价
						costprice:$("#costPrice").val(),//	成本价
						commoditytypeid:$("#commoditytypeid").val(),//	商品类型ID
						commodityimg:$("[name=file]").attr("commodityimg"),	//商品图片
						stockcount:$("[name=goodkuchun]").val(),//	库存
						infomation:editor.txt.html(),//	商品信息
						shopid:user.shopid,
					}
			var list=[];
		
			for (var i = 0; i <  $("[name=commodityDetailID]").length; i++) {
				//alert("第"+i+1+"个条形码："+$("[name=commodityDetailID]").eq(i).html())
				var b={
					commoditydetailid:$("[name=commodityDetailID]").eq(i).html(),//条形码，主键
					productcodeid:$("#productCodeID").val(),//商品主表ID
					colorid:$("[name=colorID]").eq(i).attr("colorid"),//商品颜色ID
					commoditysizeid:$("[name=productCodeID]").eq(i).attr("productcodeid"),	//商品尺码
					count:0,//数量
				}
				//alert($(".desc").eq(i).val()+"/"+$(".subtotal").eq(i).val()+"/"+$(".picturepath").eq(i).attr("picturepath"))
				list.push(b);
			}
			
			console.info("商品新增信息")
			console.info(obj)
			//alert(JSON.stringify(obj))
			//alert(record)
			$.ajax({
				url:'[[@{/CommodityController/insertSelective2}]]',
				type:"post",
			  	data : JSON.stringify(obj),
			  	dataType:'json',	
			  	contentType : "application/json;charset=utf-8",
			  	success:function (data) {
			  		//alert(data.message)
			  		$.ajax({
						url:'[[@{/CommodityController/insertSelective3}]]',
						type:"post",
					  	data : JSON.stringify(list),
					  	dataType:'json',	
					  	contentType : "application/json;charset=utf-8",
					  	success:function (data) {
					  		//alert(data.message)
							window.location.href ="[[@{/topage/page/claim/shop_managerment}]]";
				        }
					});
		        }
			});
			
	}
</script>
</html>